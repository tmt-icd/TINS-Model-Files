subsystem = TINS
component = PFC Assembly

publish = {
  events = [

    # ------------------------------------------------------------
    #  Camera status (≈ 1 Hz)
    # ------------------------------------------------------------
    {
      name = camStatus
      description = """Camera state and key temperatures."""
      maxRate = 1
      attributes = [
        {
          name = state
          description = """Operating state."""
          enum = [Idle,Exposing,Error]
        }
        {
          name = sensorTemp
          description = """Detector temperature."""
          type = double
          units = degC
        }
        {
          name = headTemp
          description = """Camera head temperature."""
          type = double
          units = degC
        }
      ]
    }

    # ------------------------------------------------------------
    #  Stage position (≈ 2 Hz)
    # ------------------------------------------------------------
    {
      name = stagePosition
      description = """Current 5-DOF stage pose."""
      maxRate = 2
      attributes = [

        {
          name = x
          description = """X position (millimetres)."""
          type = double
          units = millimeter
        }
        {
          name = y
          description = """Y position (millimetres)."""
          type = double
          units = millimeter
        }
        {
          name = z
          description = """Z position (millimetres)."""
          type = double
          units = millimeter
        }
        {
          name = rx
          description = """Tip (Rx) in **milliradians**."""
          type = double
          units = NoUnits
        }
        {
          name = ry
          description = """Tilt (Ry) in **milliradians**."""
          type = double
          units = NoUnits
        }

      ]
    }

    # ------------------------------------------------------------
    #  Streaming status  (≈ 1 Hz while streaming)
    # ------------------------------------------------------------
    {
      name = streamStatus
      description = """Health & progress of continuous acquisition."""
      maxRate = 1
      attributes = [

        {
          name = streaming
          description = """True if continuous mode is active."""
          type = boolean
        }
        {
          name = frameRate
          description = """Requested frame rate (fps)."""
          type = integer
          units = NoUnits
        }
        {
          name = framesCaptured
          description = """Total frames captured in this streaming session."""
          type = long
        }

      ]
    }
    
    # ------------------------------------------------------------
    #  Image delivery trigger (one-shot per exposure)
    # ------------------------------------------------------------
    {
      name = imageReady
      description = """Indicates a FITS image is available on VBDS."""
      attributes = [
        {
          name = imageId
          description = """Unique image identifier."""
          type = string
        }
        {
          name = timestamp
          description = """UTC epoch-ms at exposure end."""
          type = long
          units = utc
        }
      ]
    }

  ]
}