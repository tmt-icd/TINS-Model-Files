subsystem = TINS
component = PFC Assembly

receive=[

  # ------------------------------------------------------------
  #  Detector configuration
  # ------------------------------------------------------------
  {
    name = setExposureTime
    description = """Set the exposure time for the next image (seconds)."""
    completionType = immediate
    requiredArgs = ["exptime"]
    args = [
      {
        name = exptime
        description = """Exposure duration."""
        type = double
        units = second
      }
    ]
  }

  {
    name = setROI
    description = """Define the Region of Interest (ROI) in detector pixels."""
    completionType = immediate
    requiredArgs = ["x","y","width","height"]
    args = [
      {
        name = x
        description = """ROI origin X."""
        type = integer
        units = pix
      }
      {
        name = y
        description = """ROI origin Y."""
        type = integer
        units = pix
      }
      {
        name = width
        description = """ROI width."""
        type = integer
        units = pix
      }
      {
        name = height
        description = """ROI height."""
        type = integer
        units = pix
      }
    ]
  }

  {
    name = setBinning
    description = """Select on-chip binning mode (1×1 or 2×2)."""
    completionType = immediate
    requiredArgs = ["mode"]
    args = [
      {
        name = mode
        description = """Binning mode."""
        enum = [1x1,2x2]
      }
    ]
  }

  # ------------------------------------------------------------
  #  Stage and filter wheel
  # ------------------------------------------------------------
  {
    name = moveStage
    description = """Move the 5-DOF stage to the demanded pose."""
    completionType = longRunning
    requiredArgs = ["x","y","z","rx","ry"]
    args = [

      {
        name = x
        description = """X demand (millimetres)."""
        type = double
        units = millimeter
      }
      {
        name = y
        description = """Y demand (millimetres)."""
        type = double
        units = millimeter
      }
      {
        name = z
        description = """Z demand (millimetres)."""
        type = double
        units = millimeter
      }
      {
        name = rx
        description = """Tip (Rx) in **milliradians**."""
        type = double
        units = NoUnits
      }
      {
        name = ry
        description = """Tilt (Ry) in **milliradians**."""
        type = double
        units = NoUnits
      }

    ]
  }

  {
    name = selectFilter
    description = """Rotate filter wheel to the given slot (1–6)."""
    completionType = immediate
    requiredArgs = ["position"]
    args = [
      {
        name = position
        description = """Filter slot number."""
        type = integer
      }
    ]
  }

  # ------------------------------------------------------------
  #  Exposure control
  # ------------------------------------------------------------
  {
    name = startExposure
    description = """Begin an exposure with the current settings."""
    completionType = longRunning
  }

  {
    name = stopExposure
    description = """Abort the current exposure (if any)."""
    completionType = immediate
  }

  # ------------------------------------------------------------
  #  Diagnostics
  # ------------------------------------------------------------
  {
    name = requestStatus
    description = """Force an immediate camStatus publish."""
    completionType = immediate
  }
  
  # ------------------------------------------------------------
  #  Continuous (streaming) exposure mode
  # ------------------------------------------------------------
  {
    name = startStreaming
    description = """Begin continuous acquisition at the requested frame rate."""
    completionType = longRunning
    requiredArgs = ["frameRate"]
    args = [

      {
        name = frameRate
        description = """Frames per second (integer; values above 10 fps require sub-ROI)."""
        type = integer
        units = NoUnits
      }

    ]
  }

  {
    name = stopStreaming
    description = """Stop the current continuous acquisition."""
    completionType = immediate
  }
]